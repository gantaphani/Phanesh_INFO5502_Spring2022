leonard greger appeals the district court order affirming the commissioner of social security commissioner denial of social security disability insurance benefits under title ii of the social security act.we have jurisdiction pursuant to,and we affirm.
facts and procedural history 
greger applied for social security disability insurance benefits on january.he alleged that he became disabled on june,due to triple bypass surgery,high blood pressure,a defective aorta,fibromyalgia,bad knees,and stomach problems.greger disability insurance lapsed on december,and so he must establish that he was disabled and unable to work from the alleged onset date,june,to december,the relevant period.
greger was years old,with a education,when his insured status expired.at his hearing on october,greger testified that he worked as a truck driver until and was after that,doing miscellaneous jobs until shortly before he had open heart surgery in june.greger also had surgery in july to remove a perianal abscess with followup surgery in november.greger testified that,during the relevant period,he experienced pain when sitting or standing for more than minutes at a time,or walking more than half a block,shortness of breath with activity such as walking,and fatigue and shortness of breath caused by his heart medication,atenolol.he said that he had suffered from carpal tunnel syndrome for five years.he also testified that the veterans administration va diagnosed him with post traumatic stress disorder ptsd in august,with a disability rating of also,stomach surgery in left him with dumping syndrome,a difficulty in controlling one bowels.
the administrative law judge alj went through the sequential evaluation process as required by at step one,the alj determined that greger was not performing substantial gainful activity.at steps two and three,the alj found that greger suffered from severe cardiac,gastrointestinal and musculoskeletal impairments,as well as gout and hypertension,but that his condition did not meet or equal a listed impairment.the alj also found that greger ptsd and other psychological problems did not meet the criteria for a severe mental impairment during the relevant period.at steps four and five,the alj found that greger problems prevented him from doing his past relevant work as a truck driver and carpenter,but that he retained the residual functional capacity rfc during the relevant period to perform other work at a light level of exertion.accordingly,the alj found that greger was not disabled.
greger appealed the alj decision to the district court,and the magistrate judge entered judgment for the commissioner.on appeal to this court,greger advances the same issues he raised in the court below that substantial evidence does not support the alj findings that greger and his former girlfriend,lois shields,are not credible and that the alj rfc analysis was erroneous because it did not include all of greger claimed limitations.greger also raises two new issues that he did not raise in the district court that the alj erred by concluding that his psychological problems were not severe when the va had rated him with a mental disability and by not ordering a consultative psychological exam in order to fully develop the record.
standard of review 
we review de novo a district court order upholding a denial of social security disability benefits.flaten sec y of health human,cir.this review is limited,however,and we may set aside a denial of benefits only if it is not supported by substantial evidence or if it is based on legal error.id.citation omitted.
discussion 
greger argues that the alj erred in finding him not credible and rejecting his testimony regarding his limitations.
to reject greger subjective complaints,the alj must provide specific,cogent reasons for the disbelief.lester,at quoting rashad sullivan,cir.in the absence of evidence that greger is malingering,the alj reasons for rejecting his testimony must be clear and convincing.swenson sullivan,cir.when an alj finds that a claimant testimony relating to the intensity of his pain and other limitations is unreliable,the alj must make a credibility determination citing the reasons why the testimony is unpersuasive.morgan comm r of soc.sec,cir citing bunnell sullivan,cir.in making a credibility determination,the alj must specifically identify what testimony is credible and what testimony undermines the claimant complaints.in this regard,questions of credibility and resolutions of conflicts in the testimony are functions solely of the secretary.id.citations omitted.
the alj provided clear and convincing reasons for rejecting greger testimony and gave a detailed written opinion summarizing the specific statements by greger that were not credible and the evidence that undermined greger complaints.during the relevant period and into,greger failed to report any shortness of breath or chest pain there was no evidence that greger participated in a planned cardiac rehabilitation program and he never reported problems related to carpal tunnel syndrome.moreover,greger told the va in that he did carpentry work under the table through,well after his date last insured.the alj noted evidence that after his surgery greger was active with yard work,work around the house,and that he was able to continue his past work activities as a contractor.
likewise,the alj did not find shields credible and so disregarded her affidavit which attested to greger fatigue and shortness of breath following his surgery and to pain and numbness in his hands.
while an alj must take into account lay witness testimony about a claimant symptoms,the alj may discount that testimony by providing reasons that are germane to each witness.dodrill shalala,cir.the alj found that shields statements are inconsistent with greger presentation to treating physicians during the period at issue,and with greger failure to participate in cardiac rehabilitation.the alj also considered shields close relationship with greger,and that she was possibly influenced by her desire to help him.the alj reasons for doubting shields credibility are germane to her accordingly,it was not error for the alj to disregard her testimony.
greger also argues that this matter must be remanded so that the alj can examine shields and properly assess her credibility.at the hearing,however,greger attorney agreed to have shields submit an affidavit in lieu of testifying due to the lack of time that day.accordingly,there is no error.
greger argues that the alj erred in assessing his rfc because the hypothetical posed to the vocational expert at greger hearing did not specifically include greger claim that the atenolol produced the side effect of fatigue.the alj,though,is free to accept or reject restrictions in a hypothetical question that are not supported by substantial evidence.osenbrock apfel,cir.because greger did not report any fatigue to his doctors during the relevant period,the alj properly limited the hypothetical to the medical assumptions supported by substantial evidence in the record.
greger argues for the first time on appeal that the alj erred in finding his psychological problems not severe when the va had rated him disabled due to ptsd and that the alj failed to develop the record by not ordering a consultative psychological evaluation.greger has waived these issues because he did not raise them before the district court.the ninth circuit recognizes three exceptions to the general rule that the court will not consider an issue raised for the first time on appeal in the exceptional case in which review is necessary to prevent a miscarriage of justice or to preserve the integrity of the judicial process,when a new issue arises while appeal is pending because of a change in the law,or when the issue presented is purely one of law and either does not depend on the factual record developed below,or the pertinent record has been fully developed.bolker,cir citations omitted.the court will only excuse a failure to comply with this rule when necessary to avoid a manifest injustice.meanel apfel,cir.
greger argues that the alj made legal errors and that it would be an injusti