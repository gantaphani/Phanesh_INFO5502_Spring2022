in september,daniel berry,a military veteran and former commercial courier driver born in,filed a claim for disability insurance benefits under and supplemental security income benefits under.his claim was denied upon a finding that he could return to his past relevant work and therefore was not disabled.that finding was based in part on the conclusion that whether berry could pass a drug test was irrelevant to the determination of disability,even if berry could prove that he needed to be able to pass such a test to perform his past relevant work.we disagree with that conclusion and therefore remand for further administrative proceedings.
background 
before his alleged disability,daniel berry worked about years as a military communications and computer supervisor,followed by about years as a courier driver.he left his job as a courier driver on june.
as a veteran,berry sought treatment for various medical conditions through the department of veterans affairs va.in september,the va determined that berry was entitled to individual unemployability status as of july,finding that his main difficulty with unemployment is his pain regime and that potential employers would not tend to hire him due to his inability to pass a drug test due to his pain medications,abnormal gait and limitations due to his service connected low back disability.
berry applied for social security disability benefits in september.he claims that he has been disabled since his last date of employment as a courier driver in june and that his disability is a result of chronic low back pain,degenerative disk disease,degenerative arthritis on both hips,bilateral knee degeneration,sleep apnea,depression,diabetes,obesity,hearing loss,hemorrhoids and night sweats.after the social security administration ssa denied his claim,berry sought and obtained a hearing before an administrative law judge alj.
at his hearing in july,berry argued that he could not return to his past relevant work as a courier driver because that job has a mandatory drug testing requirement that his prescribed pain medications would cause him to fail.the alj observed that the general job description in the dictionary of occupational titles dot does not mention a drug testing requirement and declined as irrelevant berry offer to prove that the job carries such a requirement in practice.nor did the alj consider whether,if such a requirement exists,berry was physically capable of meeting it.
in a decision dated september,the alj performed a sequential evaluation and determined that berry was not disabled.see describing the sequential evaluation for assessing disability claims.at step one,the alj found that berry had not engaged in substantial gainful activity since june.at step two,he found that berry had one medically determinable impairment that significantly limited his ability perform basic work activities lower back pain.the alj also considered and rejected berry claims that several other conditions impaired his ability to work.at step three,the alj determined that berry qualifying impairment does not meet the criteria to establish disability automatically,regardless of age,education or work experience.in order to determine at step four whether berry could return to his past work,the alj performed a residual functional capacity rfc analysis.during that analysis,the alj discounted some of berry subjective complaints about the effects of his lower back pain,finding them inconsistent with some of his activities.having completed his rfc findings,the alj found that berry could return to his past work as a courier notwithstanding his functional limitations.the alj therefore found that berry was not disabled,without reaching step five.
berry appealed the alj decision to the district court.the district court affirmed the alj,adopting over berry objections a magistrate judge report and recommendation.this appeal followed.
standard of review 
we have jurisdiction under.we review de novo a district court judgment upholding the denial of social security benefits.bray comm r of soc.sec,cir.we will set aside a denial of benefits only if it is not supported by substantial evidence or is based on legal error.id.quoting robbins soc.sec,cir.
discussion 
berry argues that the alj erred by finding that berry could return to his past work regardless of whether that work has a drug testing requirement that he could not meet because of his prescription pain medication.we agree with berry.if a drug prescription disqualifies a claimant from performing his past relevant work,he is not capable of returning to that work.therefore,the alj erred by precluding berry from making a record whether his medically required need to take prescription drugs would bar him from working as a courier.
the ssa regulations explain that a t the fourth step,we consider our assessment of your residual functional capacity and your past relevant work.if you can still do your past relevant work,we will find that you are not disabled.a iv.to make this determination,the ssa will compare its assessment of your residual functional capacity with the physical and mental demands of your past relevant work.id.b see also id.f same social security ruling,wl,at explaining that step four requires careful consideration of the interaction of the limiting effects of the person impairment s and the physical and mental demands of his or her past relevant work to determine whether the individual can still do that work.generally,a claimant who is physically and mentally capable of performing past relevant work is not disabled,whether or not he could actually obtain employment.see d a requiring that claimant disability be determined regardless of whether he would be hired if he applied for work.
applying this requirement,the alj and the district court concluded that any requirement that couriers be free or nearly free of prescription pain medication would be a mere hiring practice,relevant to whether berry could obtain his past work but not relevant to whether he could perform,not a physical or mental demand of the work and therefore not relevant to the disability determination.in particular,the alj observed accurately during the hearing that the dot job description for couriers does not include the ability to pass a drug test as a requirement of the job,see dot,wl,and the magistrate judge,in the report the district court adopted,expressly concluded that inability to pass a drug test is not the kind of,physical or mental limitation or restriction the social security regulations contemplate.the commissioner so argues on appeal.
we reject these restricted readings of the law.if it is true,as berry offered to prove,that berry prescribed medication regime to treat his potentially disabling condition would categorically prevent him from obtaining work as a courier by rendering him physically unable to pass a drug test that is mandatory across employers,then he can not meaningfully be said to be capable of working as a courier.a mandatory requirement that employers can not hire people with a certain level of pain medication in their blood is in essence a physical demand of the job.the alj was not permitted to ignore the possibility that such a mandatory requirement exists,in the face of berry offer of proof,merely because no such physical demand appears in the dot.
a mandatory drug testing requirement of the kind berry alleges is not a mere hiring practice that is irrelevant to the determination of disability.under d a,an individual is disabled only if his physical or mental impairment is of such severity that he is unable to do his previous work or engage in any other kind of substantial gainful work regardless of whether he would be hired if he applied for work.the language excluding consideration of whether a claimant who sought work would in fact be hired can not be construed to include a hiring practice that is directly tied to the claimant disability.otherwise,the limiting language would defeat the entire statutory scheme,which provides benefits for individuals who can not work due to a disability.this understanding of the intended to exclude from consideration employer prefer